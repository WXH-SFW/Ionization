# 2017011987_Wangxiaohan_hw2
## Eigenvalue problem in hydrodynamics
1.  The equation is reduced to an eigenvalue problem on matrix $A$. The proof is as follows.
\[\frac{\partial \rho}{\partial t}+\nabla \cdot(\rho \boldsymbol{v})=0\]
\[\frac{d v}{d t} \equiv \frac{\partial v}{\partial t}+v \cdot(\nabla v)=-a^{2} \frac{\nabla \rho}{\rho}\]
\[\frac{\partial}{\partial t}\left(\begin{array}{c}{\rho_{1}} \\ {v_{x 1}}\end{array}\right)+\left(\begin{array}{cc}{v_{0}} & {\rho_{0}} \\ {a^{2} / \rho_{0}} & {v_{0}}\end{array}\right) \frac{\partial}{\partial x}\left(\begin{array}{c}{\rho_{1}} \\ {v_{x 1}}\end{array}\right)=0\]
\[\frac{\partial}{\partial t} \boldsymbol{W}+A \frac{\partial}{\partial x} \boldsymbol{W}=0\]
\[\boldsymbol{W}=\boldsymbol{W}_{0} e^{\mathrm{i}(k x-\omega t)}\]
\[-i\omega\boldsymbol{W}_{0}+ikA\boldsymbol{W}_{0} = 0\]
\[(-\omega+Ak)\boldsymbol{W}_{0} = 0\]
\[A\boldsymbol{W}_{0} = \frac{\omega}{k}\boldsymbol{W}_{0}\]
$\boldsymbol{W}_{0}$ is an eigenvector of $A$, while eigenvalue equals $\frac{\omega}{k}$. 
2.  
3.  
4.  
## Poisson solver
1.  
```
import numpy as np
import math
import matplotlib as mpl
mpl.use('Agg')
from matplotlib import pyplot as plt
import sys

# get a matrix for index, in which the ghost cell is contained
def index_(n):
    I = []
    for i in np.arange(n+2):
        for j in np.arange(n+2):
            I.append([i,j])
    I.remove([0,0])
    I.remove([0,n+1])
    I.remove([n+1,0])
    I.remove([n+1,n+1])
    return I
# define the vector b
def vector_b(n,I):
    b = np.zeros(len(I))
    for i in np.arange(1,n+1):
        for j in np.arange(1,n+1):
            x = -10 + (i - 0.5)
            y = -10 + (j - 0.5)
            b[I.index([i,j])] = math.exp(-0.5*(x**2+y**2))
    return b
# define the coefficient matrix A
def coefficient(n,I):
    A = np.zeros((len(I),len(I)))
    for i in np.arange(1,n+1):
        for j in np.arange(1,n+1):
            A[I.index([i,j]),I.index([i,j])] = -4
            A[I.index([i,j]),I.index([i+1,j])] = 1
            A[I.index([i,j]),I.index([i,j+1])] = 1
            A[I.index([i,j]),I.index([i-1,j])] = 1
            A[I.index([i,j]),I.index([i,j-1])] = 1
    # ghost cell
    for j in np.arange(1,n+1):
        A[I.index([0,j]),I.index([0,j])] = 1
        A[I.index([0,j]),I.index([1,j])] = 1
        A[I.index([j,0]),I.index([j,0])] = 1
        A[I.index([j,0]),I.index([j,1])] = 1
        A[I.index([n+1,j]),I.index([n,j])] = 1
        A[I.index([n+1,j]),I.index([n+1,j])] = 1
        A[I.index([j,n+1]),I.index([j,n])] = 1
        A[I.index([j,n+1]),I.index([j,n+1])] = 1
    return A
```
Jacobi method
```
# Jacobi
def Jacobi(A,D,L,U,b):
    D_i = np.zeros(np.shape(A))
    for i in np.arange(len(A)):
        D_i[i,i] = 1/D[i,i]
    J = np.zeros(np.shape(A))
    for i in np.arange(len(A)):
        J[i] = A[i]/A[i,i]
        J[i,i] = 0
    x_0 = np.zeros(len(b))
    R_J = []
    while True:
        x = np.dot(D_i,b) - np.dot(J,x_0)
        R = np.dot(A,x) - b
        norm_R = np.linalg.norm(R)
        R_J.append(norm_R)
        if norm_R < 10**(-6):
            break
        else:
            x_0 = x
    return x,R_J
```
Gauss-Seidel
```
# GS
def GS(A,D,L,U,b):
    G = lt_inverse(D + L)
    x_0 = np.zeros(len(b))
    R_G = []
    while True:
        x = np.dot(G,b) - np.dot(np.dot(G,U),x_0)
        R = np.dot(A,x) - b
        norm_R = np.linalg.norm(R)
        R_G.append(norm_R)
        if norm_R < 10**(-6):
            break
        else:
            x_0 = x
    return x,R_G
```
Successive over relaxation
```
def SOR(A,D,L,U,b):
    Omega = 1.5
    S = lt_inverse(D + Omega*L)
    x_0 = np.zeros(len(b))
    R_S = []
    while True:
        x = np.dot(Omega*S,b) + np.dot(np.dot(S,((1-Omega)*D-Omega*U)),x_0)
        R = np.dot(A,x) - b
        norm_R = np.linalg.norm(R)
        R_S.append(norm_R)
        if norm_R < 10**(-6):
            break
        else:
            x_0 = x
    return x,R_S
```
Steepest descent
```
# steepest descent
def sd(A,b):
    x_0 = np.zeros(len(b))
    R_SD = []
    r_0 = b - np.dot(A,x_0)
    while True:
        alpha = np.dot(r_0,r_0)/(np.dot(r_0,np.dot(A,r_0)))
        r = r_0 - alpha*np.dot(A,r_0)
        x = x_0 + alpha*r_0
        R = np.dot(A,x) - b
        norm_R = np.linalg.norm(R)
        R_SD.append(norm_R)
        if norm_R < 10**(-6):
            break
        else:
            x_0 = x
            r_0 = r
    return x,R_SD
```
Conjugate gradient
```
def cg(A,b):
    x_0 = np.zeros(len(b))
    p_0 = b - np.dot(A,x_0)
    r_0 = b - np.dot(A,x_0)
    R_C = []
    while True:
        alpha = np.dot(r_0,r_0)/(np.dot(p_0,np.dot(A,p_0)))
        r = r_0 - alpha*np.dot(A,p_0)
        beta = np.dot(r,r)/np.dot(r_0,r_0)
        x = x_0 + alpha*p_0
        p = r + beta*p_0
        R = np.dot(A,x) - b
        norm_R = np.linalg.norm(R)
        R_C.append(norm_R)
        if norm_R < 10**(-6):
            break
        else:
            x_0 = x
            r_0 = r
            p_0 = p
    return x,R_C
```
Do the calculation
```
if __name__ == '__main__':
    n = int(sys.argv[1])
    I = index_(n)
    b = vector_b(n,I)
    A = coefficient(n,I)
    D = np.zeros(np.shape(A))
    L = np.zeros(np.shape(A))
    U = np.zeros(np.shape(A))
    for i in np.arange(len(A)):
        D[i,i] = A[i,i]
        L[i,:i] = A[i,:i]
        U[i,i+1:] = A[i,i+1:]
    
    x_1,R_J = Jacobi(A,D,L,U,b)
    x_2,R_G = GS(A,D,L,U,b)
    x_3,R_S = SOR(A,D,L,U,b)
    x_4,R_SD = sd(A,b)
    x_5,R_C = cg(A,b)
```
It is confusing that the SOR solution and steepest descent method I write do not converge. It is strange that the residual reduces first, and then it goes up. In addition, the SOR solution converges at $\omega = 1.2$, but it doesn't work when $\omega = 1.5$. So I set $\omega = 1.2$ instead to get the solution and picture.

The answers are printed.

x_1
```
[ 0.00427171  0.01281514  0.02134421  0.02980143  0.03805845  0.04589276
  0.0529772   0.05889427  0.06318789  0.06545502  0.06545502  0.06318789
  0.05889427  0.0529772   0.04589276  0.03805845  0.02980143  0.02134421
  0.01281514  0.00427171  0.00427171 -0.00427171 -0.01281514 -0.02134421
 -0.02980143 -0.03805845 -0.04589276 -0.0529772  -0.05889427 -0.06318789
 -0.06545502 -0.06545502 -0.06318789 -0.05889427 -0.0529772  -0.04589276
 -0.03805845 -0.02980143 -0.02134421 -0.01281514 -0.00427171  0.00427171
  0.01281514 -0.01281514 -0.0384598  -0.06410446 -0.08960452 -0.11459805
 -0.13842815 -0.16009898 -0.17830625 -0.19159017 -0.19863219 -0.19863219
 -0.19159017 -0.17830625 -0.16009898 -0.13842815 -0.11459805 -0.08960452
 -0.06410446 -0.0384598  -0.01281514  0.01281514  0.02134421 -0.02134421
 -0.06410446 -0.10700931 -0.14991416 -0.19230109 -0.23312281 -0.27068436
 -0.3026416  -0.32623437 -0.33885141 -0.33885141 -0.32623437 -0.3026416
 -0.27068436 -0.23312281 -0.19230109 -0.14991416 -0.10700931 -0.06410446
 -0.02134421  0.02134421  0.02980143 -0.02980143 -0.08960452 -0.14991416
 -0.21074175 -0.27156936 -0.33107768 -0.38687407 -0.43534145 -0.47185434
 -0.49168771 -0.49168771 -0.47185434 -0.43534145 -0.38687407 -0.33107768
 -0.27156936 -0.21074175 -0.14991416 -0.08960452 -0.02980143  0.02980143
  0.03805845 -0.03805845 -0.11459805 -0.19230109 -0.27156936 -0.35215693
 -0.43274453 -0.51039284 -0.57999584 -0.63415387 -0.66435743 -0.66435743
 -0.63415387 -0.57999584 -0.51039284 -0.43274453 -0.35215693 -0.27156936
 -0.19230109 -0.11459805 -0.03805845  0.03805845  0.04589276 -0.04589276
 -0.13842815 -0.23312281 -0.33107768 -0.43274453 -0.53735073 -0.64195696
 -0.74009525 -0.82040784 -0.86723054 -0.86723054 -0.82040784 -0.74009525
 -0.64195696 -0.53735073 -0.43274453 -0.33107768 -0.23312281 -0.13842815
 -0.04589276  0.04589276  0.0529772  -0.0529772  -0.16009898 -0.27068436
 -0.38687407 -0.51039284 -0.64195696 -0.77998899 -0.91801867 -1.04013877
 -1.11689107 -1.11689107 -1.04013877 -0.91801867 -0.77998899 -0.64195696
 -0.51039284 -0.38687407 -0.27068436 -0.16009898 -0.0529772   0.0529772
  0.05889427 -0.05889427 -0.17830625 -0.3026416  -0.43534145 -0.57999584
 -0.74009525 -0.91801867 -1.11175562 -1.3045274  -1.44137354 -1.44137354
 -1.3045274  -1.11175562 -0.91801867 -0.74009525 -0.57999584 -0.43534145
 -0.3026416  -0.17830625 -0.05889427  0.05889427  0.06318789 -0.06318789
 -0.19159017 -0.32623437 -0.47185434 -0.63415387 -0.82040784 -1.04013877
 -1.3045274  -1.6105775  -1.86392804 -1.86392804 -1.6105775  -1.3045274
 -1.04013877 -0.82040784 -0.63415387 -0.47185434 -0.32623437 -0.19159017
 -0.06318789  0.06318789  0.06545502 -0.06545502 -0.19863219 -0.33885141
 -0.49168771 -0.66435743 -0.86723054 -1.11689107 -1.44137354 -1.86392804
 -2.25332839 -2.25332839 -1.86392804 -1.44137354 -1.11689107 -0.86723054
 -0.66435743 -0.49168771 -0.33885141 -0.19863219 -0.06545502  0.06545502
  0.06545502 -0.06545502 -0.19863219 -0.33885141 -0.49168771 -0.66435743
 -0.86723054 -1.11689107 -1.44137354 -1.86392804 -2.25332839 -2.25332839
 -1.86392804 -1.44137354 -1.11689107 -0.86723054 -0.66435743 -0.49168771
 -0.33885141 -0.19863219 -0.06545502  0.06545502  0.06318789 -0.06318789
 -0.19159017 -0.32623437 -0.47185434 -0.63415387 -0.82040784 -1.04013877
 -1.3045274  -1.6105775  -1.86392804 -1.86392804 -1.6105775  -1.3045274
 -1.04013877 -0.82040784 -0.63415387 -0.47185434 -0.32623437 -0.19159017
 -0.06318789  0.06318789  0.05889427 -0.05889427 -0.17830625 -0.3026416
 -0.43534145 -0.57999584 -0.74009525 -0.91801867 -1.11175562 -1.3045274
 -1.44137354 -1.44137354 -1.3045274  -1.11175562 -0.91801867 -0.74009525
 -0.57999584 -0.43534145 -0.3026416  -0.17830625 -0.05889427  0.05889427
  0.0529772  -0.0529772  -0.16009898 -0.27068436 -0.38687407 -0.51039284
 -0.64195696 -0.77998899 -0.91801867 -1.04013877 -1.11689107 -1.11689107
 -1.04013877 -0.91801867 -0.77998899 -0.64195696 -0.51039284 -0.38687407
 -0.27068436 -0.16009898 -0.0529772   0.0529772   0.04589276 -0.04589276
 -0.13842815 -0.23312281 -0.33107768 -0.43274453 -0.53735073 -0.64195696
 -0.74009525 -0.82040784 -0.86723054 -0.86723054 -0.82040784 -0.74009525
 -0.64195696 -0.53735073 -0.43274453 -0.33107768 -0.23312281 -0.13842815
 -0.04589276  0.04589276  0.03805845 -0.03805845 -0.11459805 -0.19230109
 -0.27156936 -0.35215693 -0.43274453 -0.51039284 -0.57999584 -0.63415387
 -0.66435743 -0.66435743 -0.63415387 -0.57999584 -0.51039284 -0.43274453
 -0.35215693 -0.27156936 -0.19230109 -0.11459805 -0.03805845  0.03805845
  0.02980143 -0.02980143 -0.08960452 -0.14991416 -0.21074175 -0.27156936
 -0.33107768 -0.38687407 -0.43534145 -0.47185434 -0.49168771 -0.49168771
 -0.47185434 -0.43534145 -0.38687407 -0.33107768 -0.27156936 -0.21074175
 -0.14991416 -0.08960452 -0.02980143  0.02980143  0.02134421 -0.02134421
 -0.06410446 -0.10700931 -0.14991416 -0.19230109 -0.23312281 -0.27068436
 -0.3026416  -0.32623437 -0.33885141 -0.33885141 -0.32623437 -0.3026416
 -0.27068436 -0.23312281 -0.19230109 -0.14991416 -0.10700931 -0.06410446
 -0.02134421  0.02134421  0.01281514 -0.01281514 -0.0384598  -0.06410446
 -0.08960452 -0.11459805 -0.13842815 -0.16009898 -0.17830625 -0.19159017
 -0.19863219 -0.19863219 -0.19159017 -0.17830625 -0.16009898 -0.13842815
 -0.11459805 -0.08960452 -0.06410446 -0.0384598  -0.01281514  0.01281514
  0.00427171 -0.00427171 -0.01281514 -0.02134421 -0.02980143 -0.03805845
 -0.04589276 -0.0529772  -0.05889427 -0.06318789 -0.06545502 -0.06545502
 -0.06318789 -0.05889427 -0.0529772  -0.04589276 -0.03805845 -0.02980143
 -0.02134421 -0.01281514 -0.00427171  0.00427171  0.00427171  0.01281514
  0.02134421  0.02980143  0.03805845  0.04589276  0.0529772   0.05889427
  0.06318789  0.06545502  0.06545502  0.06318789  0.05889427  0.0529772
  0.04589276  0.03805845  0.02980143  0.02134421  0.01281514  0.00427171]
```
x_2
```
[ 0.00427171  0.01281513  0.02134419  0.02980142  0.03805843  0.04589273
  0.05297718  0.05889424  0.06318787  0.065455    0.065455    0.06318787
  0.05889425  0.05297719  0.04589275  0.03805844  0.02980143  0.0213442
  0.01281514  0.00427171  0.00427171 -0.00427171 -0.01281514 -0.02134419
 -0.02980142 -0.03805843 -0.04589274 -0.05297718 -0.05889425 -0.06318787
 -0.065455   -0.065455   -0.06318788 -0.05889426 -0.05297719 -0.04589275
 -0.03805844 -0.02980143 -0.02134421 -0.01281514 -0.00427171  0.00427171
  0.01281513 -0.01281514 -0.03845978 -0.06410442 -0.08960448 -0.114598
 -0.13842809 -0.16009893 -0.17830619 -0.19159012 -0.19863215 -0.19863215
 -0.19159014 -0.17830622 -0.16009897 -0.13842813 -0.11459804 -0.08960452
 -0.06410446 -0.0384598  -0.01281514  0.01281514  0.02134419 -0.02134419
 -0.06410442 -0.10700925 -0.14991409 -0.19230101 -0.23312273 -0.27068428
 -0.30264152 -0.3262343  -0.33885135 -0.33885136 -0.32623433 -0.30264157
 -0.27068434 -0.2331228  -0.19230108 -0.14991416 -0.10700931 -0.06410446
 -0.02134421  0.02134421  0.02980142 -0.02980142 -0.08960448 -0.14991409
 -0.21074167 -0.27156926 -0.33107758 -0.38687397 -0.43534135 -0.47185425
 -0.49168764 -0.49168765 -0.47185429 -0.43534142 -0.38687405 -0.33107768
 -0.27156936 -0.21074176 -0.14991417 -0.08960453 -0.02980144  0.02980144
  0.03805843 -0.03805843 -0.114598   -0.19230101 -0.27156926 -0.35215683
 -0.43274442 -0.51039273 -0.57999574 -0.63415378 -0.66435736 -0.66435737
 -0.63415383 -0.57999582 -0.51039283 -0.43274454 -0.35215695 -0.27156938
 -0.19230111 -0.11459806 -0.03805845  0.03805845  0.04589273 -0.04589274
 -0.13842809 -0.23312273 -0.33107758 -0.43274442 -0.53735062 -0.64195685
 -0.74009515 -0.82040775 -0.86723047 -0.86723049 -0.82040781 -0.74009524
 -0.64195697 -0.53735075 -0.43274456 -0.33107772 -0.23312284 -0.13842817
 -0.04589277  0.04589277  0.05297718 -0.05297718 -0.16009893 -0.27068428
 -0.38687397 -0.51039273 -0.64195685 -0.77998889 -0.91801857 -1.04013869
 -1.11689102 -1.11689104 -1.04013876 -0.91801867 -0.77998902 -0.641957
 -0.51039288 -0.38687412 -0.2706844  -0.16009901 -0.05297721  0.05297721
  0.05889424 -0.05889425 -0.17830619 -0.30264152 -0.43534135 -0.57999574
 -0.74009515 -0.91801857 -1.11175555 -1.30452734 -1.44137351 -1.44137353
 -1.30452741 -1.11175565 -0.91801871 -0.74009531 -0.5799959  -0.43534151
 -0.30264165 -0.17830629 -0.05889428  0.05889428  0.06318787 -0.06318787
 -0.19159012 -0.3262343  -0.47185425 -0.63415378 -0.82040775 -1.04013869
 -1.30452734 -1.61057747 -1.86392803 -1.86392806 -1.61057754 -1.30452745
 -1.04013884 -0.82040792 -0.63415395 -0.47185441 -0.32623444 -0.19159021
 -0.06318791  0.06318791  0.065455   -0.065455   -0.19863215 -0.33885135
 -0.49168764 -0.66435736 -0.86723047 -1.11689102 -1.44137351 -1.86392803
 -2.2533284  -2.25332842 -1.8639281  -1.44137362 -1.11689117 -0.86723064
 -0.66435753 -0.4916878  -0.33885149 -0.19863224 -0.06545504  0.06545504
  0.065455   -0.065455   -0.19863215 -0.33885136 -0.49168765 -0.66435737
 -0.86723049 -1.11689104 -1.44137353 -1.86392806 -2.25332842 -2.25332845
 -1.86392813 -1.44137364 -1.11689119 -0.86723066 -0.66435755 -0.49168781
 -0.3388515  -0.19863225 -0.06545504  0.06545504  0.06318787 -0.06318788
 -0.19159014 -0.32623433 -0.47185429 -0.63415383 -0.82040781 -1.04013876
 -1.30452741 -1.61057754 -1.8639281  -1.86392813 -1.61057761 -1.30452751
 -1.0401389  -0.82040797 -0.63415399 -0.47185445 -0.32623446 -0.19159023
 -0.06318791  0.06318791  0.05889425 -0.05889426 -0.17830622 -0.30264157
 -0.43534142 -0.57999582 -0.74009524 -0.91801867 -1.11175565 -1.30452745
 -1.44137362 -1.44137364 -1.30452751 -1.11175576 -0.91801881 -0.74009539
 -0.57999597 -0.43534157 -0.30264169 -0.17830631 -0.05889429  0.05889429
  0.05297719 -0.05297719 -0.16009897 -0.27068434 -0.38687405 -0.51039283
 -0.64195697 -0.77998902 -0.91801871 -1.04013884 -1.11689117 -1.11689119
 -1.0401389  -0.91801881 -0.77998914 -0.6419571  -0.51039297 -0.38687419
 -0.27068445 -0.16009904 -0.05297722  0.05297722  0.04589275 -0.04589275
 -0.13842813 -0.2331228  -0.33107768 -0.43274454 -0.53735075 -0.641957
 -0.74009531 -0.82040792 -0.86723064 -0.86723066 -0.82040797 -0.74009539
 -0.6419571  -0.53735087 -0.43274467 -0.3310778  -0.2331229  -0.1384282
 -0.04589278  0.04589278  0.03805844 -0.03805844 -0.11459804 -0.19230108
 -0.27156936 -0.35215695 -0.43274456 -0.51039288 -0.5799959  -0.63415395
 -0.66435753 -0.66435755 -0.63415399 -0.57999597 -0.51039297 -0.43274467
 -0.35215706 -0.27156946 -0.19230117 -0.1145981  -0.03805847  0.03805847
  0.02980143 -0.02980143 -0.08960452 -0.14991416 -0.21074176 -0.27156938
 -0.33107772 -0.38687412 -0.43534151 -0.47185441 -0.4916878  -0.49168781
 -0.47185445 -0.43534157 -0.38687419 -0.3310778  -0.27156946 -0.21074184
 -0.14991423 -0.08960457 -0.02980145  0.02980145  0.0213442  -0.02134421
 -0.06410446 -0.10700931 -0.14991417 -0.19230111 -0.23312284 -0.2706844
 -0.30264165 -0.32623444 -0.33885149 -0.3388515  -0.32623446 -0.30264169
 -0.27068445 -0.2331229  -0.19230117 -0.14991423 -0.10700936 -0.06410449
 -0.02134422  0.02134422  0.01281514 -0.01281514 -0.0384598  -0.06410446
 -0.08960453 -0.11459806 -0.13842817 -0.16009901 -0.17830629 -0.19159021
 -0.19863224 -0.19863225 -0.19159023 -0.17830631 -0.16009904 -0.1384282
 -0.1145981  -0.08960457 -0.06410449 -0.03845982 -0.01281515  0.01281515
  0.00427171 -0.00427171 -0.01281514 -0.02134421 -0.02980144 -0.03805845
 -0.04589277 -0.05297721 -0.05889428 -0.06318791 -0.06545504 -0.06545504
 -0.06318791 -0.05889429 -0.05297722 -0.04589278 -0.03805847 -0.02980145
 -0.02134422 -0.01281515 -0.00427172  0.00427172  0.00427171  0.01281514
  0.02134421  0.02980144  0.03805845  0.04589277  0.05297721  0.05889428
  0.06318791  0.06545504  0.06545504  0.06318791  0.05889429  0.05297722
  0.04589278  0.03805847  0.02980145  0.02134422  0.01281515  0.00427172]
```
x_3
```
[ 0.00427171  0.01281513  0.02134418  0.02980141  0.03805841  0.04589272
  0.05297716  0.05889423  0.06318785  0.06545499  0.06545499  0.06318786
  0.05889425  0.05297718  0.04589275  0.03805844  0.02980143  0.0213442
  0.01281514  0.00427171  0.00427171 -0.00427171 -0.01281513 -0.02134419
 -0.02980141 -0.03805842 -0.04589273 -0.05297717 -0.05889424 -0.06318786
 -0.06545499 -0.065455   -0.06318787 -0.05889425 -0.05297719 -0.04589275
 -0.03805844 -0.02980143 -0.02134421 -0.01281514 -0.00427171  0.00427171
  0.01281513 -0.01281513 -0.03845976 -0.0641044  -0.08960445 -0.11459797
 -0.13842806 -0.1600989  -0.17830617 -0.19159009 -0.19863212 -0.19863213
 -0.19159012 -0.17830621 -0.16009896 -0.13842813 -0.11459804 -0.08960452
 -0.06410446 -0.0384598  -0.01281515  0.01281515  0.02134418 -0.02134419
 -0.0641044  -0.10700922 -0.14991406 -0.19230097 -0.23312268 -0.27068423
 -0.30264148 -0.32623426 -0.33885131 -0.33885133 -0.3262343  -0.30264155
 -0.27068433 -0.2331228  -0.19230108 -0.14991417 -0.10700931 -0.06410446
 -0.02134421  0.02134421  0.02980141 -0.02980141 -0.08960445 -0.14991406
 -0.21074162 -0.27156921 -0.33107753 -0.38687392 -0.4353413  -0.4718542
 -0.4916876  -0.49168762 -0.47185427 -0.4353414  -0.38687405 -0.33107768
 -0.27156936 -0.21074177 -0.14991418 -0.08960454 -0.02980144  0.02980144
  0.03805841 -0.03805842 -0.11459797 -0.19230097 -0.27156921 -0.35215677
 -0.43274436 -0.51039267 -0.57999568 -0.63415373 -0.66435732 -0.66435734
 -0.63415381 -0.5799958  -0.51039283 -0.43274454 -0.35215696 -0.27156939
 -0.19230112 -0.11459807 -0.03805846  0.03805846  0.04589272 -0.04589273
 -0.13842806 -0.23312268 -0.33107753 -0.43274436 -0.53735056 -0.64195679
 -0.7400951  -0.82040771 -0.86723044 -0.86723047 -0.8204078  -0.74009524
 -0.64195697 -0.53735077 -0.43274458 -0.33107773 -0.23312286 -0.13842818
 -0.04589277  0.04589277  0.05297716 -0.05297717 -0.1600989  -0.27068423
 -0.38687392 -0.51039267 -0.64195679 -0.77998883 -0.91801853 -1.04013866
 -1.11689099 -1.11689103 -1.04013875 -0.91801868 -0.77998903 -0.64195702
 -0.51039291 -0.38687414 -0.27068442 -0.16009903 -0.05297722  0.05297722
  0.05889423 -0.05889424 -0.17830617 -0.30264148 -0.4353413  -0.57999568
 -0.7400951  -0.91801853 -1.11175551 -1.30452731 -1.44137349 -1.44137353
 -1.30452741 -1.11175567 -0.91801874 -0.74009534 -0.57999594 -0.43534154
 -0.30264168 -0.17830631 -0.05889429  0.05889429  0.06318785 -0.06318786
 -0.19159009 -0.32623426 -0.4718542  -0.63415373 -0.82040771 -1.04013866
 -1.30452731 -1.61057745 -1.86392803 -1.86392806 -1.61057756 -1.30452748
 -1.04013887 -0.82040796 -0.63415399 -0.47185445 -0.32623447 -0.19159024
 -0.06318791  0.06318792  0.06545499 -0.06545499 -0.19863212 -0.33885131
 -0.4916876  -0.66435732 -0.86723044 -1.11689099 -1.44137349 -1.86392803
 -2.25332841 -2.25332844 -1.86392814 -1.44137366 -1.11689121 -0.86723069
 -0.66435758 -0.49168785 -0.33885152 -0.19863227 -0.06545505  0.06545505
  0.06545499 -0.065455   -0.19863213 -0.33885133 -0.49168762 -0.66435734
 -0.86723047 -1.11689103 -1.44137353 -1.86392806 -2.25332844 -2.25332848
 -1.86392817 -1.44137369 -1.11689124 -0.86723072 -0.6643576  -0.49168786
 -0.33885154 -0.19863228 -0.06545505  0.06545505  0.06318786 -0.06318787
 -0.19159012 -0.3262343  -0.47185427 -0.63415381 -0.8204078  -1.04013875
 -1.30452741 -1.61057756 -1.86392814 -1.86392817 -1.61057766 -1.30452757
 -1.04013896 -0.82040804 -0.63415406 -0.4718545  -0.3262345  -0.19159026
 -0.06318792  0.06318792  0.05889425 -0.05889425 -0.17830621 -0.30264155
 -0.4353414  -0.5799958  -0.74009524 -0.91801868 -1.11175567 -1.30452748
 -1.44137366 -1.44137369 -1.30452757 -1.11175582 -0.91801887 -0.74009546
 -0.57999604 -0.43534162 -0.30264174 -0.17830634 -0.0588943   0.0588943
  0.05297718 -0.05297719 -0.16009896 -0.27068433 -0.38687405 -0.51039283
 -0.64195697 -0.77998903 -0.91801874 -1.04013887 -1.11689121 -1.11689124
 -1.04013896 -0.91801887 -0.77998921 -0.64195717 -0.51039304 -0.38687424
 -0.27068449 -0.16009907 -0.05297723  0.05297723  0.04589275 -0.04589275
 -0.13842813 -0.2331228  -0.33107768 -0.43274454 -0.53735077 -0.64195702
 -0.74009534 -0.82040796 -0.86723069 -0.86723072 -0.82040804 -0.74009546
 -0.64195717 -0.53735094 -0.43274473 -0.33107785 -0.23312294 -0.13842823
 -0.04589279  0.04589279  0.03805844 -0.03805844 -0.11459804 -0.19230108
 -0.27156936 -0.35215696 -0.43274458 -0.51039291 -0.57999594 -0.63415399
 -0.66435758 -0.6643576  -0.63415406 -0.57999604 -0.51039304 -0.43274473
 -0.35215711 -0.27156951 -0.19230121 -0.11459812 -0.03805847  0.03805847
  0.02980143 -0.02980143 -0.08960452 -0.14991417 -0.21074177 -0.27156939
 -0.33107773 -0.38687414 -0.43534154 -0.47185445 -0.49168785 -0.49168786
 -0.4718545  -0.43534162 -0.38687424 -0.33107785 -0.27156951 -0.21074188
 -0.14991426 -0.08960459 -0.02980146  0.02980146  0.0213442  -0.02134421
 -0.06410446 -0.10700931 -0.14991418 -0.19230112 -0.23312286 -0.27068442
 -0.30264168 -0.32623447 -0.33885152 -0.33885154 -0.3262345  -0.30264174
 -0.27068449 -0.23312294 -0.19230121 -0.14991426 -0.10700938 -0.06410451
 -0.02134422  0.02134422  0.01281514 -0.01281514 -0.0384598  -0.06410446
 -0.08960454 -0.11459807 -0.13842818 -0.16009903 -0.17830631 -0.19159024
 -0.19863227 -0.19863228 -0.19159026 -0.17830634 -0.16009907 -0.13842823
 -0.11459812 -0.08960459 -0.06410451 -0.03845983 -0.01281515  0.01281515
  0.00427171 -0.00427171 -0.01281515 -0.02134421 -0.02980144 -0.03805846
 -0.04589277 -0.05297722 -0.05889429 -0.06318791 -0.06545505 -0.06545505
 -0.06318792 -0.0588943  -0.05297723 -0.04589279 -0.03805847 -0.02980146
 -0.02134422 -0.01281515 -0.00427172  0.00427172  0.00427171  0.01281515
  0.02134421  0.02980144  0.03805846  0.04589277  0.05297722  0.05889429
  0.06318792  0.06545505  0.06545505  0.06318792  0.0588943   0.05297723
  0.04589279  0.03805847  0.02980146  0.02134422  0.01281515  0.00427172]
```
x_5
```
[ 0.00427173  0.01281518  0.02134427  0.02980152  0.03805855  0.04589288
  0.05297734  0.05889441  0.06318804  0.06545517  0.06545517  0.06318804
  0.05889441  0.05297734  0.04589288  0.03805855  0.02980152  0.02134427
  0.01281518  0.00427173  0.00427173 -0.00427173 -0.01281519 -0.02134427
 -0.02980151 -0.03805855 -0.04589288 -0.05297734 -0.05889442 -0.06318804
 -0.06545517 -0.06545517 -0.06318804 -0.05889442 -0.05297734 -0.04589288
 -0.03805855 -0.02980151 -0.02134427 -0.01281519 -0.00427173  0.00427173
  0.01281518 -0.01281519 -0.03845991 -0.06410463 -0.08960476 -0.11459834
 -0.1384285  -0.16009938 -0.17830668 -0.19159062 -0.19863266 -0.19863266
 -0.19159062 -0.17830668 -0.16009938 -0.1384285  -0.11459834 -0.08960476
 -0.06410463 -0.03845991 -0.01281519  0.01281518  0.02134427 -0.02134427
 -0.06410463 -0.1070096  -0.14991457 -0.19230158 -0.23312339 -0.27068501
 -0.30264231 -0.32623512 -0.33885218 -0.33885218 -0.32623512 -0.30264231
 -0.27068501 -0.23312339 -0.19230158 -0.14991457 -0.1070096  -0.06410463
 -0.02134427  0.02134427  0.02980152 -0.02980151 -0.08960476 -0.14991457
 -0.21074231 -0.27157004 -0.33107848 -0.38687496 -0.43534242 -0.47185536
 -0.49168875 -0.49168875 -0.47185536 -0.43534242 -0.38687496 -0.33107848
 -0.27157004 -0.21074231 -0.14991457 -0.08960476 -0.02980151  0.02980152
  0.03805855 -0.03805855 -0.11459834 -0.19230158 -0.27157004 -0.35215778
 -0.43274553 -0.51039395 -0.57999704 -0.63415513 -0.66435873 -0.66435873
 -0.63415513 -0.57999704 -0.51039395 -0.43274553 -0.35215778 -0.27157004
 -0.19230158 -0.11459834 -0.03805855  0.03805855  0.04589288 -0.04589288
 -0.1384285  -0.23312339 -0.33107848 -0.43274553 -0.53735189 -0.64195826
 -0.74009666 -0.82040933 -0.86723207 -0.86723207 -0.82040933 -0.74009666
 -0.64195826 -0.53735189 -0.43274553 -0.33107848 -0.23312339 -0.1384285
 -0.04589288  0.04589288  0.05297734 -0.05297734 -0.16009938 -0.27068501
 -0.38687496 -0.51039395 -0.64195826 -0.77999045 -0.91802024 -1.04014042
 -1.11689278 -1.11689278 -1.04014042 -0.91802024 -0.77999045 -0.64195826
 -0.51039395 -0.38687496 -0.27068501 -0.16009938 -0.05297734  0.05297734
  0.05889441 -0.05889442 -0.17830668 -0.30264231 -0.43534242 -0.57999704
 -0.74009666 -0.91802024 -1.11175734 -1.3045292  -1.4413754  -1.4413754
 -1.3045292  -1.11175734 -0.91802024 -0.74009666 -0.57999704 -0.43534242
 -0.30264231 -0.17830668 -0.05889442  0.05889441  0.06318804 -0.06318804
 -0.19159062 -0.32623512 -0.47185536 -0.63415513 -0.82040933 -1.04014042
 -1.3045292  -1.6105794  -1.86392999 -1.86392999 -1.6105794  -1.3045292
 -1.04014042 -0.82040933 -0.63415513 -0.47185536 -0.32623512 -0.19159062
 -0.06318804  0.06318804  0.06545517 -0.06545517 -0.19863266 -0.33885218
 -0.49168875 -0.66435873 -0.86723207 -1.11689278 -1.4413754  -1.86392999
 -2.25333038 -2.25333038 -1.86392999 -1.4413754  -1.11689278 -0.86723207
 -0.66435873 -0.49168875 -0.33885218 -0.19863266 -0.06545517  0.06545517
  0.06545517 -0.06545517 -0.19863266 -0.33885218 -0.49168875 -0.66435873
 -0.86723207 -1.11689278 -1.4413754  -1.86392999 -2.25333038 -2.25333038
 -1.86392999 -1.4413754  -1.11689278 -0.86723207 -0.66435873 -0.49168875
 -0.33885218 -0.19863266 -0.06545517  0.06545517  0.06318804 -0.06318804
 -0.19159062 -0.32623512 -0.47185536 -0.63415513 -0.82040933 -1.04014042
 -1.3045292  -1.6105794  -1.86392999 -1.86392999 -1.6105794  -1.3045292
 -1.04014042 -0.82040933 -0.63415513 -0.47185536 -0.32623512 -0.19159062
 -0.06318804  0.06318804  0.05889441 -0.05889442 -0.17830668 -0.30264231
 -0.43534242 -0.57999704 -0.74009666 -0.91802024 -1.11175734 -1.3045292
 -1.4413754  -1.4413754  -1.3045292  -1.11175734 -0.91802024 -0.74009666
 -0.57999704 -0.43534242 -0.30264231 -0.17830668 -0.05889442  0.05889441
  0.05297734 -0.05297734 -0.16009938 -0.27068501 -0.38687496 -0.51039395
 -0.64195826 -0.77999045 -0.91802024 -1.04014042 -1.11689278 -1.11689278
 -1.04014042 -0.91802024 -0.77999045 -0.64195826 -0.51039395 -0.38687496
 -0.27068501 -0.16009938 -0.05297734  0.05297734  0.04589288 -0.04589288
 -0.1384285  -0.23312339 -0.33107848 -0.43274553 -0.53735189 -0.64195826
 -0.74009666 -0.82040933 -0.86723207 -0.86723207 -0.82040933 -0.74009666
 -0.64195826 -0.53735189 -0.43274553 -0.33107848 -0.23312339 -0.1384285
 -0.04589288  0.04589288  0.03805855 -0.03805855 -0.11459834 -0.19230158
 -0.27157004 -0.35215778 -0.43274553 -0.51039395 -0.57999704 -0.63415513
 -0.66435873 -0.66435873 -0.63415513 -0.57999704 -0.51039395 -0.43274553
 -0.35215778 -0.27157004 -0.19230158 -0.11459834 -0.03805855  0.03805855
  0.02980152 -0.02980151 -0.08960476 -0.14991457 -0.21074231 -0.27157004
 -0.33107848 -0.38687496 -0.43534242 -0.47185536 -0.49168875 -0.49168875
 -0.47185536 -0.43534242 -0.38687496 -0.33107848 -0.27157004 -0.21074231
 -0.14991457 -0.08960476 -0.02980151  0.02980152  0.02134427 -0.02134427
 -0.06410463 -0.1070096  -0.14991457 -0.19230158 -0.23312339 -0.27068501
 -0.30264231 -0.32623512 -0.33885218 -0.33885218 -0.32623512 -0.30264231
 -0.27068501 -0.23312339 -0.19230158 -0.14991457 -0.1070096  -0.06410463
 -0.02134427  0.02134427  0.01281518 -0.01281519 -0.03845991 -0.06410463
 -0.08960476 -0.11459834 -0.1384285  -0.16009938 -0.17830668 -0.19159062
 -0.19863266 -0.19863266 -0.19159062 -0.17830668 -0.16009938 -0.1384285
 -0.11459834 -0.08960476 -0.06410463 -0.03845991 -0.01281519  0.01281518
  0.00427173 -0.00427173 -0.01281519 -0.02134427 -0.02980151 -0.03805855
 -0.04589288 -0.05297734 -0.05889442 -0.06318804 -0.06545517 -0.06545517
 -0.06318804 -0.05889442 -0.05297734 -0.04589288 -0.03805855 -0.02980151
 -0.02134427 -0.01281519 -0.00427173  0.00427173  0.00427173  0.01281518
  0.02134427  0.02980152  0.03805855  0.04589288  0.05297734  0.05889441
  0.06318804  0.06545517  0.06545517  0.06318804  0.05889441  0.05297734
  0.04589288  0.03805855  0.02980152  0.02134427  0.01281518  0.00427173]
```

The residual is plotted as a function of number of iterations.
```
    plt.figure()
    plt.plot(R_J)
    plt.title('Residual in Jacobi method')
    plt.savefig('Figure_J.png')

    plt.figure()
    plt.plot(R_G)
    plt.title('Residual in GS method')
    plt.savefig('Figure_G.png')

    plt.figure()
    plt.plot(R_S)
    plt.title('Residual in SOR method')
    plt.savefig('Figure_S.png')

    plt.figure()
    plt.plot(R_SD)
    plt.title('Residual in SD method')
    plt.savefig('Figure_SD.png')

    plt.figure()
    plt.plot(R_C)
    plt.title('Residual in CG method')
    plt.savefig('Figure_C.png')
```
The pictures are as follows
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/Figure_J.png)
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/Figure_G.png)
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/Figure_J.png)
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/Figure_J.png)

It can be shown that residual is not always monotonic.

2.  Further discuss the computation cost per iteration for each method
In Jacobi, GS and SOR method, computation cost the most per iteration. 
## Ionization equilibrium
1.  
    *   The equation has only one positive root. It can be calculated that given the coefficients, $P(0) < 0$, and $P_1(x) > 0$ when $x>0$. 
    *   The upper and lower boundary of the root:
    \[n = 10^{N}\]
    \[a = 10^{N-3}\]
    \[b = 1.5\times 10^{N}\]
2.  The code to solve this question is as follows. In this problem, $T = 30K$,$n = 10^{-5}cm^2$,$x_M = 10^{-12}$, this information has been witten in the code for convinience.
```
import sys
import numpy as np
import math
import matplotlib as mpl
mpl.use('Agg')
from matplotlib import pyplot as plt
# Assignments and coefficients
T = 30
n = 10**5
x_M = 10**(-12)
m = math.sqrt(T)
alpha = (3*10**(-6))/m
beta = (3*10**(-11))/m
gamma = 3*10**(-9)
zeta = 10**(-17)

# define the function P(x)
def P(x):
    m = math.sqrt(T)
    alpha = (3*10**(-6))/m
    beta = (3*10**(-11))/m
    gamma = 3*10**(-9)
    zeta = 10**(-17)
    P = x**3 + (beta*x_M/alpha)*x**2 - (zeta/(alpha*n))*x - (zeta*beta*x_M)/(alpha*gamma*n)
    return P
# define the first differential of P(x)
def P_1(x):
    m = math.sqrt(T)
    alpha = (3*10**(-6))/m
    beta = (3*10**(-11))/m
    zeta = 10**(-17)
    P_1  = 3*x**2 + 2*(beta*x_M/alpha)*x -  (zeta/(alpha*n))
    return P_1

# Bisecsion to find the root
def bisection(a,b,epsilon):
    error_B = []
    # store the relative error
    while True:
        c = (a+b)/2
        error_B.append(c)
        if P(a)*P(c) <= 0:
            b = c
        if P(b)*P(c) <= 0:
            a = c
        if abs(a-b) <= epsilon:
            break
    return c,error_B

# Secant method
def secant(a,b,epsilon):
    error_S = []
    # store the relative error
    while True:
        x = b - (b-a)*P(b)/(P(b)-P(a))
        error_S.append(x)
        if abs(b-x)/b <= epsilon:
            break
        else:
            a = b
            b = x
    return x, error_S
# Newton Raphson method
def NR(b,epsilon):
    error_NR = []
    # store the relative error
    while True:
        delta = P(b)/P_1(b)
        x = b - delta
        error_NR.append(x)
        if abs(b-x)/b <= epsilon:
            break
        else:
            b = x
    return x,error_NR
``` 
Do the calculation
```
a = 10**(-8)
b = (1.50)*10**(-8)
# a, b are lower and upper boundaries of the root
epsilon = 10**(-12)

c,error_B = bisection(a,b,epsilon)
x,error_S = secant(a,b,epsilon)
x_NR,error_NR = NR(b,epsilon)

# calculate the relative error
for i in np.arange(len(error_B)):
    error_B[i] = abs(error_B[i]-c)
for i in np.arange(len(error_S)):
    error_S[i] = abs(error_S[i]-x)
for i in np.arange(len(error_NR)):
    error_NR[i] = abs(error_NR[i]-x_NR)
```


The roots found by the three solutions are as follows
```
c = 1.3512573242187498e-08
x = 1.351200245594118e-08
x_NR = 1.351200245594118e-08
error_B = [1.01257324e-09 2.37426758e-10 3.87573242e-10 7.50732422e-11
 8.11767578e-11 3.05175781e-12 3.60107422e-11 1.64794922e-11
 6.71386719e-12 1.83105469e-12 6.10351563e-13 6.10351562e-13
 0.00000000e+00]
error_S = [6.88236051e-10 1.06033006e-10 8.69594340e-12 1.03226464e-13
 9.95765679e-17 1.14150925e-21 0.00000000e+00]
error_NR = [1.95646772e-10 4.11046845e-12 1.87432973e-15 3.90429249e-22
 0.00000000e+00]
```


```
# plot the relative error as a function of iteration step i
plt.figure()
plt.plot(error_B,linestyle = '-',label = 'bisection')
plt.plot(error_S,linestyle = '-.',label = 'secant method')
plt.plot(error_NR,linestyle = '--',label = 'Newton-Raphson')
plt.savefig('error.png')
```
The picture
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/error.png)
3.  calculate xe as a function of n for $n = 10^{4}cm^{−3}$ to $n= 10^{14}cm^{−3}$

We divide the interval to make the picture more clear. Part of the code is as follows.
```
n_space = np.linspace(10**4,10**5,100)
x_space = np.zeros(len(n_space))
# change the coefficients
T = 20
x_M = 10**(-10)
# change the boundaries for solution
a = 10**(-8)
b = 1.5*10**(-7)
for i in np.arange(len(n_space)):
    n = n_space[i]
    x_space[i] = bisection(a,b,epsilon)[0]
plt.plot(n_space,x_space)
```

*   $T= 20K,x_M= 10^{−10}$
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e.png)
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e1.png)
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e2.png)
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e3.png)
*   $T= 20K,x_M= 10^{−12}$
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e_10.png)
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e_11.png) 
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e_12.png) 
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e_13.png)     
*   $T= 100K,x_M= 10^{−12}$
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e_20.png) 
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e_21.png) 
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e_22.png) 
![](https://raw.githubusercontent.com/WXH-SFW/Ionization/master/x_e_23.png) 
